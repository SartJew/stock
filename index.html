<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>SART JEWELS — Каталог</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      background: #f7f7f7;
      color: #111111;
    }
    .page {
      max-width: 1080px;
      margin: 0 auto;
      padding: 24px 16px 60px;
    }
    header {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 18px;
    }
    .logo {
      font-size: 22px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      font-weight: 500;
    }
    .logo span { font-weight: 600; }
    .subtitle {
      font-size: 13px;
      color: #666666;
      max-width: 520px;
      line-height: 1.5;
    }

    .top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      align-items: center;
    }
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .filter-btn {
      border-radius: 999px;
      border: 1px solid #dddddd;
      padding: 6px 14px;
      font-size: 12px;
      background: #ffffff;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
      white-space: nowrap;
    }
    .filter-btn.active {
      background: #111111;
      color: #ffffff;
      border-color: #111111;
    }

    .search {
      flex: 1 1 180px;
      min-width: 0;
    }
    .search input {
      width: 100%;
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid #dddddd;
      font-size: 13px;
      outline: none;
      background: #ffffff;
    }
    .search input:focus {
      border-color: #111111;
    }

    .meta {
      font-size: 11px;
      color: #999999;
      margin: 6px 0 12px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 14px;
    }
    .card {
      background: #ffffff;
      border-radius: 14px;
      padding: 12px 12px 14px;
      border: 1px solid #e5e5e5;
      box-shadow: 0 4px 10px rgba(0,0,0,0.03);
      display: flex;
      flex-direction: column;
      min-height: 140px;
    }
    .card-inner {
      display: flex;
      gap: 10px;
    }
    .thumb {
      width: 88px;
      height: 88px;
      border-radius: 12px;
      overflow: hidden;
      flex-shrink: 0;
      background: #f1f1f1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #aaaaaa;
    }
    .thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .thumb.empty-text {
      padding: 6px;
      text-align: center;
      line-height: 1.3;
    }

    .card-body {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      flex: 1;
      min-width: 0;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
      gap: 4px;
    }
    .brand {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #999999;
    }
    .ref {
      font-size: 11px;
      color: #bbbbbb;
      white-space: nowrap;
    }
    .name {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 4px;
      line-height: 1.4;
    }
    .lot-meta {
      font-size: 11px;
      color: #777777;
      margin-bottom: 4px;
    }
    .price-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 13px;
      margin-top: 4px;
    }
    .price { font-weight: 600; }
    .status {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #c8e6c9;
      color: #2e7d32;
      background: #e8f5e9;
      white-space: nowrap;
    }
    .status.sold {
      border-color: #ffcdd2;
      color: #b71c1c;
      background: #ffebee;
    }
    footer {
      margin-top: 32px;
      font-size: 11px;
      color: #9a9a9a;
      border-top: 1px solid #e2e2e2;
      padding-top: 12px;
    }
    @media (max-width: 600px) {
      .page { padding: 18px 12px 40px; }
      header { gap: 8px; }
      .card-inner { flex-direction: row; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="logo"><span>SART</span> JEWELS</div>
      <div class="subtitle">
        Актуальный сток часов и ювелирных изделий. Только оригинал, новые позиции со свежей датой.
        В наличии в Москве, возможна проверка в сервис-центре. Цены указаны в долларах США.
      </div>
      <div class="top-row">
        <div class="filters">
          <button class="filter-btn active" data-brand="all">Все бренды</button>
          <button class="filter-btn" data-brand="Rolex">Rolex</button>
          <button class="filter-btn" data-brand="Cartier">Cartier</button>
          <button class="filter-btn" data-brand="Graff">Graff</button>
        </div>
        <div class="search">
          <input id="search-input" type="text" placeholder="Поиск по модели, ref или бренду…" />
        </div>
      </div>
    </header>

    <div class="meta" id="meta-info">
      Статус: все лоты «в наличии». Один лот = конкретный экземпляр товара.
    </div>

    <main>
      <div class="grid" id="products-grid"></div>
    </main>

    <footer>
      Контакт: Данил (Sart), Москва. Каталог предназначен для личных клиентов и партнёров.
      Для уточнения наличия, живых фото и условий напишите напрямую.
    </footer>
  </div>

  <script>
    // === 1. Настройки Google Sheets (на будущее) ===
    // Когда сделаем таблицу и опубликуем её в CSV,
    // сюда вставишь её CSV-ссылку вида:
    // https://docs.google.com/spreadsheets/d/ID/export?format=csv
    const SHEET_CSV_URL = ""; // пока пусто — берём локальный сток

    // === 2. Локальный сток (будет использован, пока SHEET_CSV_URL пустой или недоступен) ===
    const localProducts = [
      // Rolex — два лота одной модели с разной ценой
      { id: "r-126233-1", brand: "Rolex", ref: "126233VI", name: "Datejust 36, green dial", year: "2023", condition: "New",      set: "Full set",      price: "19 900 $", status: "in_stock", image: "https://media.rolex.com/image/upload/q_auto:eco/f_auto/t_v7-majesty/c_limit,w_1920/v1/catalogue/2025/upright-c/m126333-0010.jpg" },
      { id: "r-126233-2", brand: "Rolex", ref: "126233VI", name: "Datejust 36, green dial", year: "2021", condition: "Like new", set: "Box + papers", price: "17 900 $", status: "in_stock", image: "" },

      { id: "r-126603-1",      brand: "Rolex", ref: "126603",      name: "Sea-Dweller, black",                      year: "2023", condition: "New", set: "Full set", price: "21 000 $", status: "in_stock", image: "" },
      { id: "r-126234-1",      brand: "Rolex", ref: "126234",      name: "Datejust 36, blue dial",                  year: "2022", condition: "New", set: "Full set", price: "12 900 $", status: "in_stock", image: "" },
      { id: "r-278274vi-1",    brand: "Rolex", ref: "278274VI",    name: "Datejust 31, blue dial",                  year: "2023", condition: "New", set: "Full set", price: "12 500 $", status: "in_stock", image: "" },
      { id: "r-277200-1",      brand: "Rolex", ref: "277200",      name: "Oyster Perpetual, pistachio",             year: "2023", condition: "New", set: "Full set", price: "10 000 $", status: "in_stock", image: "" },
      { id: "r-126234vi-1",    brand: "Rolex", ref: "126234VI",    name: "Datejust 36, purple dial",                year: "2023", condition: "New", set: "Full set", price: "14 900 $", status: "in_stock", image: "" },
      { id: "r-126300-1",      brand: "Rolex", ref: "126300",      name: "Datejust 41, blue Roman",                 year: "2023", condition: "New", set: "Full set", price: "12 000 $", status: "in_stock", image: "" },
      { id: "r-126622-1",      brand: "Rolex", ref: "126622",      name: "Yacht-Master 40, blue",                   year: "2023", condition: "New", set: "Full set", price: "15 100 $", status: "in_stock", image: "" },
      { id: "r-136660-1",      brand: "Rolex", ref: "136660",      name: "Deepsea, D-Blue",                         year: "2023", condition: "New", set: "Full set", price: "16 700 $", status: "in_stock", image: "" },
      { id: "r-126300-wim-1",  brand: "Rolex", ref: "126300",      name: "Datejust 41, Wimbledon",                  year: "2023", condition: "New", set: "Full set", price: "12 000 $", status: "in_stock", image: "" },
      { id: "r-126331-wim-1",  brand: "Rolex", ref: "126331",      name: "Datejust 41, Wimbledon",                  year: "2023", condition: "New", set: "Full set", price: "19 000 $", status: "in_stock", image: "" },
      { id: "r-126333-1",      brand: "Rolex", ref: "126333",      name: "Datejust 41, black",                      year: "2023", condition: "New", set: "Full set", price: "18 700 $", status: "in_stock", image: "" },

      // Cartier
      { id: "c-wjba0050-1",    brand: "Cartier", ref: "WJBA0050",  name: "Baignoire Watch",                         year: "2023", condition: "New", set: "Full set", price: "21 300 $", status: "in_stock", image: "" },
      { id: "c-wgba0041-1",    brand: "Cartier", ref: "WGBA0041",  name: "Baignoire Watch",                         year: "2023", condition: "New", set: "Full set", price: "8 200 $",  status: "in_stock", image: "" },
      { id: "c-wjpn0063-1",    brand: "Cartier", ref: "WJPN0063",  name: "Panthère de Cartier Watch",               year: "2023", condition: "New", set: "Full set", price: "33 000 $", status: "in_stock", image: "" },
      { id: "c-wjpn0059-1",    brand: "Cartier", ref: "WJPN0059",  name: "Panthère de Cartier Watch",               year: "2023", condition: "New", set: "Full set", price: "41 000 $", status: "in_stock", image: "" },
      { id: "c-wjpn0061-1",    brand: "Cartier", ref: "WJPN0061",  name: "Panthère de Cartier Watch",               year: "2023", condition: "New", set: "Full set", price: "41 000 $", status: "in_stock", image: "" },
      { id: "c-b6084016-1",    brand: "Cartier", ref: "B6084016",  name: "Juste un Clou Bracelet, diamonds",        year: "2023", condition: "New", set: "Full set", price: "6 500 $",  status: "in_stock", image: "" },

      // Graff
      { id: "g-butterfly-ring-1",    brand: "Graff", ref: "Butterfly Ring",     name: "Classic Butterfly Petite Diamond Ring, white gold",      year: "2023", condition: "New", set: "Full set", price: "12 250 $", status: "in_stock", image: "" },
      { id: "g-cross-medium-1",      brand: "Graff", ref: "Cross Medium",       name: "Round Diamond Cross Medium Pendant, white gold",         year: "2023", condition: "New", set: "Full set", price: "11 500 $", status: "in_stock", image: "" },
      { id: "g-cross-small-1",       brand: "Graff", ref: "Cross Small",        name: "Round Diamond Cross Small Pendant, white gold",         year: "2023", condition: "New", set: "Full set", price: "6 400 $",  status: "in_stock", image: "" },
      { id: "g-butterfly-necklace-1",brand: "Graff", ref: "Butterfly Necklace", name: "Classic Butterfly Petite Diamond Necklace, white gold", year: "2023", condition: "New", set: "Full set", price: "28 700 $", status: "in_stock", image: "" }
    ];

    let products = [];
    let currentBrand = "all";
    let currentQuery = "";

    const grid = document.getElementById("products-grid");
    const filterButtons = document.querySelectorAll(".filter-btn");
    const metaInfo = document.getElementById("meta-info");
    const searchInput = document.getElementById("search-input");

    // === 3. Загрузка из Google Sheets (если указана SHEET_CSV_URL) ===
    async function loadFromSheet() {
      if (!SHEET_CSV_URL) {
        products = localProducts;
        applyFilters();
        return;
      }
      try {
        const res = await fetch(SHEET_CSV_URL);
        const text = await res.text();
        const lines = text.split(/\r?\n/).filter(l => l.trim().length > 0);
        const header = lines.shift().split(",");
        const getIndex = name => header.indexOf(name);

        const idx = {
          id: getIndex("id"),
          brand: getIndex("brand"),
          ref: getIndex("ref"),
          name: getIndex("name"),
          year: getIndex("year"),
          condition: getIndex("condition"),
          set: getIndex("set"),
          price: getIndex("price"),
          status: getIndex("status"),
          image: getIndex("image")
        };

        products = lines.map(line => {
          const cols = line.split(","); // важно: не использовать запятые внутри полей
          return {
            id:       cols[idx.id]       ? cols[idx.id].trim()       : "",
            brand:    cols[idx.brand]    ? cols[idx.brand].trim()    : "",
            ref:      cols[idx.ref]      ? cols[idx.ref].trim()      : "",
            name:     cols[idx.name]     ? cols[idx.name].trim()     : "",
            year:     cols[idx.year]     ? cols[idx.year].trim()     : "",
            condition:cols[idx.condition]? cols[idx.condition].trim(): "",
            set:      cols[idx.set]      ? cols[idx.set].trim()      : "",
            price:    cols[idx.price]    ? cols[idx.price].trim()    : "",
            status:   cols[idx.status]   ? cols[idx.status].trim()   : "",
            image:    cols[idx.image]    ? cols[idx.image].trim()    : ""
          };
        });

        applyFilters();
      } catch (e) {
        console.error("Ошибка загрузки Google Sheets, используем локальный сток", e);
        products = localProducts;
        applyFilters();
      }
    }

    // === 4. Фильтрация по бренду + поиску ===
    function applyFilters() {
      grid.innerHTML = "";

      const q = currentQuery.toLowerCase().trim();

      const visible = products.filter(p => {
        if (p.status !== "in_stock") return false;
        if (currentBrand !== "all" && p.brand !== currentBrand) return false;

        if (q) {
          const haystack = (p.brand + " " + p.ref + " " + p.name).toLowerCase();
          if (!haystack.includes(q)) return false;
        }
        return true;
      });

      if (visible.length === 0) {
        grid.innerHTML = "<div style='font-size:13px;color:#888;'>Нет лотов в наличии по заданным условиям.</div>";
        metaInfo.textContent = "Ничего не найдено. Проверьте фильтр бренда или запрос в поиске.";
        return;
      }

      metaInfo.textContent = `Показано лотов: ${visible.length}. Бренд: ${currentBrand === "all" ? "все" : currentBrand}.` ;

      visible.forEach(p => {
        const card = document.createElement("div");
        card.className = "card";

        const detailsLine = [
          "Год: " + (p.year || "—"),
          "Состояние: " + (p.condition || "—"),
          "Комплект: " + (p.set || "—")
        ].join(" · ");

        const hasImage = p.image && p.image.length > 3;

        card.innerHTML = `
          <div class="card-inner">
            <div class="thumb ${hasImage ? "" : "empty-text"}">
              ${hasImage ? `<img src="${p.image}" alt="${p.name}">` : "Фото<br>по запросу"}
            </div>
            <div class="card-body">
              <div>
                <div class="card-header">
                  <div class="brand">${p.brand}</div>
                  <div class="ref">${p.ref}</div>
                </div>
                <div class="name">${p.name}</div>
                <div class="lot-meta">${detailsLine}</div>
              </div>
              <div class="price-row">
                <div class="price">${p.price}</div>
                <div class="status">в наличии</div>
              </div>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // === 5. Обработчики фильтров и поиска ===
    filterButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        filterButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentBrand = btn.getAttribute("data-brand");
        applyFilters();
      });
    });

    searchInput.addEventListener("input", () => {
      currentQuery = searchInput.value;
      applyFilters();
    });

    // Старт
    loadFromSheet();
  </script>
</body>
</html>
